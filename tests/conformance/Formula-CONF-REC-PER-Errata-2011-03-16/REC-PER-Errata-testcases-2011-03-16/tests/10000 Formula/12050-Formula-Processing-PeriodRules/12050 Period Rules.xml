<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2007 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../../../infrastructure/test.xsl"?>
<testcase
  xmlns="http://xbrl.org/2008/conformance"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://xbrl.org/2008/conformance ../../../infrastructure/test.xsd"
  xmlns:xbrlfe="http://xbrl.org/2008/formula/error"
  xmlns:binding="http://xbrl.org/2008/binding/errors"
  xmlns:label="http://xbrl.org/2008/label/error"
  xmlns:reference="http://xbrl.org/2008/reference/error"  
  >
  <creator>
    <name>Herm Fischer</name>
    <email>fischer@markv.com</email>
  </creator>
  <number>12050</number>
  <name>Period rules processing examples</name>
  <description>
    Tests of formula period rules processing
  </description>
  <reference specification="FORMULA" id="sec-period-rules"/>
  <reference specification="FORMULA" id="sec-default-aspect-rules"/>

  <variation id="V-01">
    <name>Output of source instant period</name>
    <description>Tests that the output instant period is that of the input.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-source-instant-formula.xml</linkbase>
      <instance readMeFirst="true">12050-source-instant-instance.xml</instance>
    </data>
    <result>
      <instance>12050-source-instant-result.xml</instance>
    </result>
  </variation>

  <variation id="V-02">
    <name>Output of dynamic instant period from date without time part</name>
    <description>Tests that the output instant period is that of the formula aspect rule, specified as an xs:date without time portion, so result is midnight at end of that date.  A formula processor may output the produced context as date without time (2008-02-29), or as date with time (2008-03-01T00:00:00 or 2008-02-29T24:00:00).  The test harness comparing produced result to expected result should accept s-equals contexts, so any of these instant (or endDate) dates in the result should be s-equals to each other (2008-02-29, 2008-03-01T00:00:00, or 2008-02-29T24:00:00)</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-instant-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-instant-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-instant-result.xml</instance>
    </result>
  </variation>
v
  <variation id="V-03">
    <name>Output of dynamic instant period from date with time part</name>
    <description>Tests that the output instant period is that of the formula aspect rule, specified as an xs:dateTime with time portion, so result is midnight at start of that date.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-instant-2-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-instant-2-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-instant-2-result.xml</instance>
    </result>
  </variation>

  <variation id="V-04">
    <name>Output of dynamic instant period from computation based on item date and offset</name>
    <description>Tests that the output instant period is that of the item instant date (reported without time) offset by a duration usinga XPath dateTime + duration arithmetic.  Assures that the instant reported without time is offset to subsequent midnight and proper dateTime results.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-instant-3-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-instant-3-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-instant-3-result.xml</instance>
    </result>
  </variation>

  <variation id="V-05">
    <name>Output of dynamic forever period</name>
    <description>Tests that the output forever period is that of the formula aspect rule.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-forever-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-forever-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-forever-result.xml</instance>
    </result>
  </variation>  

  <variation id="V-06">
    <name>Output of dynamic instant item contexts based on dynamic period start and end dates without times</name>
    <description>Tests that the output instant period of end is the day after period end.  E.g., if one had a movement with changes from Jan 1 to Dec 31, balances at start and end would both be New Year Eve's times.  There are two formulas, one to output a result based on instant of the start of source duration item's period, the second to output a result based on the instant of the end of the source duration item's period.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-start-end-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-start-end-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-start-end-result.xml</instance>
    </result>
  </variation>  

  <variation id="V-07">
    <name>Output of dynamic instant item contexts based on dynamic period start and end dates with times</name>
    <description>Tests that the output instant period of end with time is as reported.  E.g., if one had a movement with changes from Jan 1 00 hrs to Dec 31 00 hrs, balances at start would be New Year Eve's time but balance at end would be Dec 31 00 hrs (midnight before New Year's eve).  Uses same formula as V-06 to assure proper date with and without time treatment.</description>
    <reference specification="FORMULA" id="example-period-rules"/>
    <data>
      <schema>12050-period-tests.xsd</schema>
      <linkbase>12050-dynamic-start-end-formula.xml</linkbase>
      <instance readMeFirst="true">12050-dynamic-start-end-2-instance.xml</instance>
    </data>
    <result>
      <instance>12050-dynamic-start-end-2-result.xml</instance>
    </result>
  </variation>  


</testcase>


