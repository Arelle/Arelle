<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2007 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../../../infrastructure/test.xsl"?>
<testcase
xmlns="http://xbrl.org/2008/conformance"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
  http://xbrl.org/2008/conformance 
  ../../../infrastructure/test.xsd">
  <creator>
    <name>Herm Fischer</name>
    <email>fischer@markv.com</email>
  </creator>
  <number>43230</number>
  <name>Dimension Member Filter Processing</name>
  <description>
    Test dimension member filter processing.  Instance based on seven highest peaks per region of world.
  </description>
  <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>

  <variation id="V-01">
    <name>A dimension's value must be reported</name>
    <description>
      Facts missing the required dimension are reported to the
      resulting instance.  A complement dimensionMember filter
      causes selection of those facts lacking the required dimension.
      There is no member element.  
      The linkrole is that of the has-hypercube "all" arc (.../primaryItems, 
      vs. .../primaryItems2, e.g., that which
      includes the missing dimension that is present on other item
      contexts), and
      that the DRS from that arc includes all dimension-members to be
      considered for this function.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-dimension-test-concepts.xsd</schema>
      <linkbase>43230-dimension-test-concepts-definition.xml</linkbase>
      <linkbase>43230-missingLocation-formula.xml</linkbase>
      <instance readMeFirst="true">43230-sevenSummits-missingLocation-instance.xml</instance>
    </data>
    <result>
      <instance>43230-sevenSummits-missingLocation-result.xml</instance>
    </result>
  </variation>

  <variation id="V-02">
    <name>A child of a specified domain member must be reported</name>
    <description>
       Facts must report a value for the eg:Location that is one of the domain members with an immediate (child) member relationship from the domain member eg:Melanesia.  Linkrole is that of the has hypercube "all" arc.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-dimension-test-concepts.xsd</schema>
      <linkbase>43230-dimension-test-concepts-definition.xml</linkbase>
      <linkbase>43230-melanesiaChild-formula.xml</linkbase>
      <instance readMeFirst="true">43230-sevenSummits-melanesiaChild-instance.xml</instance>
    </data>
    <result>
      <instance>43230-sevenSummits-melanesiaChild-result.xml</instance>
    </result>
  </variation>

  <variation id="V-03">
    <name>A child of, or the specified domain member, must be reported</name>
    <description>
       Facts must report a value for the eg:Location that is one of the domain members with an immediate (child-or-self) member relationship from the domain member eg:Melanesia.  Linkrole is that of the has-hypercube "all" arc.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-dimension-test-concepts.xsd</schema>
      <linkbase>43230-dimension-test-concepts-definition.xml</linkbase>
      <linkbase>43230-melanesiaChildOrSelf-formula.xml</linkbase>
      <instance readMeFirst="true">43230-sevenSummits-melanesiaChildOrSelf-instance.xml</instance>
    </data>
    <result>
      <instance>43230-sevenSummits-melanesiaChildOrSelf-result.xml</instance>
    </result>
  </variation>

  <variation id="V-04">
    <name>A descendant of a specified domain member must be reported</name>
    <description>
      Facts must report a value for the eg:Location that is one of the domain members with a descendant of member relationship from the domain member eg:Oceania.  The linkrole indicated is that of has-hypercube "all" arc.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-dimension-test-concepts.xsd</schema>
      <linkbase>43230-dimension-test-concepts-definition.xml</linkbase>
      <linkbase>43230-oceaniaDescendant-formula.xml</linkbase>
      <instance readMeFirst="true">43230-sevenSummits-oceaniaDescendant-instance.xml</instance>
    </data>
    <result>
      <instance>43230-sevenSummits-oceaniaDescendant-result.xml</instance>
    </result>
  </variation>

  <variation id="V-05">
    <name>A descendant of, or the a specified domain member, must be reported</name>
    <description>
      Facts must report a value for the eg:Location that is one of the domain members with a descendant of, or the specified member itself, of the relationship from the domain member eg:Indonesia.  The linkrole indicated is that of the has-hypercube "all" arc.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-dimension-test-concepts.xsd</schema>
      <linkbase>43230-dimension-test-concepts-definition.xml</linkbase> 
      <linkbase>43230-indonesiaDescendantOrSelf-formula.xml</linkbase>
      <instance readMeFirst="true">43230-sevenSummits-indonesiaDescendantOrSelf-instance.xml</instance>
    </data>
    <result>
      <instance>43230-sevenSummits-indonesiaDescendantOrSelf-result.xml</instance>
    </result>
  </variation>

  <variation id="V-06">
    <name>
      A fact item may ambiguously fit multiple link role has-hypercube relations, finrep-like example, ambiguity 1 of 2
    </name>
    <description>
      Fact item n1 has a context with one dimension (dim2 member dim2Mem1) which can either be link role 1dimRole, or be linkrole 2dimRole where dim1 takes its default member.  In this variation the dimension filter for n1 filters based on link role 1dimRole and a single dimension.  As with the finrep production case, it can't by itself reject the multidimensioned link role because implicit matching will carry the dim1 aspect to this fact variable and mess things up.  Therefore a hard-to-explain complement filter, marked with comment 'really awful' in formula linkbase, is needed to block the other link role's dimension from "leaking" in here.  Without it you will also get results 70000, 80000, and 90000. (I hope the linkrole can be added to the dimension aspects in implicit filtering as proposed on wiki page on 13/08/08.)  (Follows Base Spec WG decision to allow this situation due to legacy.) 
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-finrepAmbiguity-test1.xsd</schema>
      <linkbase>43230-finrepAmbiguity-test1-definition.xml</linkbase> 
      <linkbase>43230-finrepAmbiguity-test1-formula1.xml</linkbase>
      <instance readMeFirst="true">43230-finrepAmbiguity-test1-instance1.xml</instance>
    </data>
    <result>
      <instance>43230-finrepAmbiguity-test1-result-1-2.xml</instance>
    </result>
  </variation>

  <variation id="V-07">
    <name>
      A fact item may ambiguously fit multiple link role has-hypercube relations, finrep-like example, ambiguity 2 of 2
    </name>
    <description>
      Same as V-06 but in this variation the dimension filter for n1 filters based on link role 2dimRole and two dimension, where dim1 takes the default value dim1Total. (Continues the really awful problem of V-06.)
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>43230-finrepAmbiguity-test1.xsd</schema>
      <linkbase>43230-finrepAmbiguity-test1-definition.xml</linkbase> 
      <linkbase>43230-finrepAmbiguity-test1-formula2.xml</linkbase>
      <instance readMeFirst="true">43230-finrepAmbiguity-test1-instance2.xml</instance>
    </data>
    <result>
      <instance>43230-finrepAmbiguity-test1-result-1-2.xml</instance>
    </result>
  </variation>

  <variation id="V-08">
    <name>Dimension value test, value is non-item xml element</name>
    <description>
      Facts having the indicated dimension value are reported, the member
      is an XML QName that is not in the xbrl:item substitution group.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>42320-open-hc-test-1.xsd</schema>
      <linkbase>42320-open-hc-test-1-definition.xml</linkbase>
      <linkbase>43230-openHc-formula-1.xml</linkbase>
      <instance readMeFirst="true">43230-openHc-instance-1.xml</instance>
    </data>
    <result>
      <instance>43230-openHc-result-1.xml</instance>
    </result>
  </variation>

  <variation id="V-09">
    <name>Dimension value test, value in non-item xml element members hierarchy</name>
    <description>
      Facts having child of indicated dimension value are reported, the member
      is an XML QName that is not in the xbrl:item substitution group,
      the member hierarchy is related by a generic arc.
    </description>
    <reference specification="DIMENSION-FILTER" id="sec-explicit-dimension-filter"/>
    <data>
      <schema>42320-open-hc-test-2.xsd</schema>
      <linkbase>42320-open-hc-test-2-definition.xml</linkbase>
      <linkbase>43230-open-hc-test-2-member-hierarchy.xml</linkbase>
      <linkbase>43230-openHc-formula-2.xml</linkbase>
      <instance readMeFirst="true">43230-openHc-instance-2.xml</instance>
    </data>
    <result>
      <instance>43230-openHc-result-2.xml</instance>
    </result>
  </variation>

</testcase>


