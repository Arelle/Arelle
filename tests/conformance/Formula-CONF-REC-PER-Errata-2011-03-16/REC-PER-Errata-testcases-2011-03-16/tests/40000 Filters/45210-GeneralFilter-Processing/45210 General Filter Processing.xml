<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2007 XBRL International. All Rights Reserved. -->
<?xml-stylesheet type="text/xsl" href="../../../infrastructure/test.xsl"?>
<testcase
xmlns="http://xbrl.org/2008/conformance"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
  http://xbrl.org/2008/conformance 
  ../../../infrastructure/test.xsd">
  <creator>
    <name>Herm Fischer</name>
    <email>fischer@markv.com</email>
  </creator>
  <number>45210</number>
  <name>General Filter Processing</name>
  <description>
    Test general filter processing.
  </description>
  <reference specification="GENERAL-FILTER" id="sec-general-filter"/>

  <variation id="V-01">
    <name>Test that a fact value has a custom attribute of a specified value</name>
    <description>
      The fact must have a custom attribute called &lt;eg:custom&gt; with a value of confidential.  Only facts matching this are processed for this example.  (Note that the result does not include the source custom attribute on the resulting fact item.)
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-custAttrValue-formula.xml</linkbase>
      <instance readMeFirst="true">45210-custAttrValue-instance.xml</instance>
    </data>
    <result>
      <instance>45210-custAttrValue-result.xml</instance>
    </result>
  </variation>

  <variation id="V-02">
    <name>Date check that context period is before scenario's restatementDate</name>
    <description>
      The fact must be reported with an instant or a duration end date that is less than the value of the &lt;eg:restatementDate&gt; element in the fact's scenario. 
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-restatementFilter-formula.xml</linkbase>
      <instance readMeFirst="true">45210-restatementFilter-instance.xml</instance>
    </data>
    <result>
      <instance>45210-restatementFilter-result.xml</instance>
    </result>
  </variation>

  <variation id="V-03">
    <name>Test a general value filter on string text</name>
    <description>
      String text filter testing.
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-textValueTest-formula.xml</linkbase>
      <instance readMeFirst="true">45210-textValueTest-instance.xml</instance>
    </data>
    <result>
      <instance>45210-textValueTest-result.xml</instance>
    </result>
  </variation>

  <variation id="V-04">
    <name>Test that a general filter test applies only to concepts which filter for it, integer concept</name>
    <description>
      There are facts that are numeric, decimal, and QName.  A general variable filter for
      the QName or string fact would generate the XPTY0004 error if attempting the
      numeric general filter test on it.  The test is only expected to be performed for
      those items passing any concept filter(s).
Note:  type safe coding is used in general filter because there currently are no filter interdependencies defined.
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-mixedValues-1-formula.xml</linkbase>
      <instance readMeFirst="true">45210-mixedValues-1-instance.xml</instance>
    </data>
    <result>
      <instance>45210-mixedValues-1-result.xml</instance>
    </result>
  </variation>

  <variation id="V-05">
    <name>Test that a general filter test applies only to concepts which filter for it, QNamed concept</name>
    <description>
      There are facts that are numeric, decimal, and QName.  A general variable filter for
      the numeric or string fact would generate the XPTY0004 error if attempting the
      QName general filter test on it.  The test is only expected to be performed for
      those items passing any concept filter(s).
Note:  type safe coding is used in general filter because there currently are no filter interdependencies defined.
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-mixedValues-2-formula.xml</linkbase>
      <instance readMeFirst="true">45210-mixedValues-2-instance.xml</instance>
    </data>
    <result>
      <instance>45210-mixedValues-2-result.xml</instance>
    </result>
  </variation>

  <variation id="V-06">
    <name>Test that a general filter test applies only to concepts which filter for it, wrong concept</name>
    <description>
      There are facts that are numeric, decimal, and QName.  A general variable filter for
      the numeric or string fact would generate the XPTY0004 error if attempting the
      QName general filter test on it.  The test is is performed for a name-filtered 
      decimal concept,
      thus raising the error.
Note:  type safe coding is NOT used in general filter thus causing the error irrespective of any concept name filtering.
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-mixedValues-3-formula.xml</linkbase>
      <instance readMeFirst="true">45210-mixedValues-3-instance.xml</instance>
    </data>
    <result>
      <error xmlns:e1="http://www.w3.org/2005/xqt-errors">e1:XPTY0004</error>
    </result>
  </variation>

  <variation id="V-07">
    <name>Test that a general filter test applies only to concepts which filter for it, wrong concept</name>
    <description>
      There are facts that are numeric, decimal, and QName.  A general variable filter for
      the numeric or string fact would generate the XPTY0004 error if attempting the
      QName general filter test on it.  The test is is performed for all fact items
      as there is no concept filter, thus raising the error (on the non-eg:q items).
Note:  type safe coding is NOT used in general filter thus causing the error irrespective of any concept name filtering.
    </description>
    <reference specification="GENERAL-FILTER" id="sec-general-filter"/>
    <data>
      <schema>45210-generalFilter-concepts.xsd</schema>
      <linkbase>45210-mixedValues-4-formula.xml</linkbase>
      <instance readMeFirst="true">45210-mixedValues-4-instance.xml</instance>
    </data>
    <result>
      <error xmlns:e2="http://www.w3.org/2005/xqt-errors">e2:XPTY0004</error>
    </result>
  </variation>

</testcase>

